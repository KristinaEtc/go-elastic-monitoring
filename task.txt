[1:14:01 AM] l: ок
[1:14:08 AM] l: разобрался откуда ошибка лезет
[1:14:31 AM] l: с 00 по 03 создается новый индекс, в котором только данные от воркера и go-stomp-server
[1:14:42 AM] l: а в них нет одного поля, которое я использую в скриптах
[1:15:02 AM] l: начиная с 03 часов начинают приходить в индекс данные от моих сервисов и там это поле есть
[1:20:38 AM] l: Index(subNode.Index + "-" + *utc).
имена не очень хорошо выбираешь
[1:20:55 AM] l: utc должно быть что-то вроде index_date
[1:21:12 AM] l: utc это время, а никак не строка для форматирования имени индекса)
[1:21:52 AM] l: тебе однозначно надо тренироваться придумать нормальные имена для переменных
[1:22:42 AM] l: timeStr = t.String()

 //cut all except date
 idx := strings.IndexAny(timeStr, " ")
 timeStr = timeStr[:idx]
это плохой код
[1:22:51 AM] l: я тебе сто раз говорил - не используй строковые функции.
[1:23:11 AM] l: то что ты хочешь здесь делать - делается через функцию форматирования.
[1:23:23 AM] l: никогда не используй для таких целей функции пиления строк.
[1:31:06 AM] l: у тебя из-за этого ошибка, которая в итоге приводит 1 of 2 shards failed
[1:31:56 AM] l: событие от воркера и go-stomd приходят в rfc3339 формате, т.е.
2016-10-16T01:29:12+03:00
они парсятся точно так же в время с таймзоной
[1:32:11 AM] l: затем ты их преобразуешь обратно в строку и отрезаешь по пробелу
[1:32:31 AM] l: из-за чего с 0 по 3 часа данные от них попадают не в индекс текущего дня по utc
[1:32:38 AM] l: а в индекс завтрашнего дня
[1:32:52 AM] l: а все что идет от меня - в текущий день
[1:33:11 AM] l: при этом поле inner.time есть только в моих данных, соответственно с 0 по 3 в новом индексе этого поля нет.
[1:33:25 AM] l: и скриптовое поле, которое я использую для расчетов - валится с ошибкой на нем.
[1:34:00 AM] l: можно конечно маппингами пофиксить, потому что обращаться к полю, которое есть только благодаря подмножеству данных - не совсем хорошая идея.
[1:34:28 AM] l: но баг с конверсией utc в имя индекса надо поправить
[1:34:38 AM] l: причем там может даже формат не поможет
[1:34:47 AM] l: нужно конвертировать время в строго таймзону utc
[1:34:50 AM] l: и потом форматировать
[1:35:12 AM] l: потому что выделять "дату" из момента времени имеет смысл только в определенной таймзоне.
[1:35:31 AM] l: один и тот же момент времени может означать разные даты в разных таймзонах
